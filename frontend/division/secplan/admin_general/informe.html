<!DOCTYPE html>
<html lang="es">

<head>
    <script src="../../../script/router.js"></script>
    <script src="../../../script/api.js"></script>
    <script src="../../../script/utils.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geoportal Municipal - Algarrobo</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- jsPDF para generar PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- SheetJS para generar Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Unified Admin Styles -->
    <link rel="stylesheet" href="styles/admin-styles.css">

    <style>
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para las tarjetas de métricas */
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Estilos para las tarjetas de informes */
        .report-card {
            transition: all 0.3s ease;
        }

        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para los filtros de informe */
        .report-filters {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Estilos para los contenedores de gráficos */
        .chart-container {
            position: relative;
            height: 300px;
        }

        /* Estilo para el spinner de carga */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Header -->
    <div id="headerRender"></div>

    <div class="flex">
        <!-- Sidebar -->
        <div id="asideRender"></div>

        <!-- Main Content -->
        <main class="flex-1 p-6">
            <!-- Reports View -->
            <div id="reportsView" class="view-content">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Informes Municipales</h2>
                    <p class="text-gray-600">Análisis detallados y reportes de gestión de proyectos</p>
                </div>

                <!-- Report Filters -->
                <div class="report-filters rounded-lg shadow p-6 mb-6 text-white">
                    <h3 class="text-lg font-semibold mb-4">Filtros de Informe</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Tipo de Informe</label>
                            <select id="reportType" onchange="updateReportPreview()"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800">
                                <option value="executive">Ejecutivo</option>
                                <option value="detailed">Detallado</option>
                                <option value="financial">Financiero</option>
                                <option value="progress">Avance</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Período</label>
                            <select id="reportPeriod" onchange="updateReportPreview()"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800">
                                <option value="monthly">Mensual</option>
                                <option value="quarterly">Trimestral</option>
                                <option value="semester">Semestral</option>
                                <option value="yearly">Anual</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Área</label>
                            <select id="reportArea" onchange="updateReportPreview()"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800">
                                <option value="all">Todas</option>
                                <option value="Saneamiento">Saneamiento</option>
                                <option value="Vialidad">Vialidad</option>
                                <option value="Espacios Públicos">Espacios Públicos</option>
                                <option value="Educación">Educación</option>
                                <option value="Salud">Salud</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Formato</label>
                            <select id="reportFormat"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800">
                                <option value="pdf">PDF</option>
                                <option value="excel">Excel</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4 flex gap-3">
                        <button id="generateBtn" onclick="generateReport()"
                            class="px-6 py-2 bg-white text-purple-700 rounded-md hover:bg-gray-100 font-medium transition">
                            <i class="fas fa-file-alt mr-2"></i>Generar Informe
                        </button>
                        <button onclick="scheduleReport()"
                            class="px-6 py-2 bg-purple-800 text-white rounded-md hover:bg-purple-900 font-medium transition">
                            <i class="fas fa-clock mr-2"></i>Programar
                        </button>
                        <button onclick="saveReportTemplate()"
                            class="px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-medium transition">
                            <i class="fas fa-save mr-2"></i>Guardar Plantilla
                        </button>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="metric-card text-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Inversión Total</p>
                                <p class="text-3xl font-bold">$25.3B</p>
                                <p class="text-sm text-purple-100 mt-2">
                                    <i class="fas fa-arrow-up mr-1"></i>8% vs período anterior
                                </p>
                            </div>
                            <i class="fas fa-dollar-sign text-4xl text-purple-200"></i>
                        </div>
                    </div>
                    <div class="metric-card text-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Proyectos Activos</p>
                                <p class="text-3xl font-bold">92</p>
                                <p class="text-sm text-purple-100 mt-2">
                                    <i class="fas fa-arrow-up mr-1"></i>12% vs período anterior
                                </p>
                            </div>
                            <i class="fas fa-project-diagram text-4xl text-purple-200"></i>
                        </div>
                    </div>
                    <div class="metric-card text-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Tasa Ejecución</p>
                                <p class="text-3xl font-bold">87%</p>
                                <p class="text-sm text-purple-100 mt-2">
                                    <i class="fas fa-arrow-up mr-1"></i>5% vs período anterior
                                </p>
                            </div>
                            <i class="fas fa-chart-line text-4xl text-purple-200"></i>
                        </div>
                    </div>
                    <div class="metric-card text-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Beneficiarios</p>
                                <p class="text-3xl font-bold">15.2K</p>
                                <p class="text-sm text-purple-100 mt-2">
                                    <i class="fas fa-users mr-1"></i>Estimado
                                </p>
                            </div>
                            <i class="fas fa-user-friends text-4xl text-purple-200"></i>
                        </div>
                    </div>
                </div>

                <!-- Report Types -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="report-card bg-white rounded-lg shadow p-6 cursor-pointer"
                        onclick="selectReportType('executive')">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-100 p-3 rounded-full mr-4">
                                <i class="fas fa-chart-pie text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold">Informe Ejecutivo</h3>
                                <p class="text-sm text-gray-600">Resumen para autoridades</p>
                            </div>
                        </div>
                        <p class="text-gray-700 text-sm">Informe resumido con KPIs principales, estado general de
                            proyectos y métricas clave para toma de decisiones estratégicas.</p>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-xs text-gray-500">Última generación: 2 días atrás</span>
                            <button class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <div class="report-card bg-white rounded-lg shadow p-6 cursor-pointer"
                        onclick="selectReportType('detailed')">
                        <div class="flex items-center mb-4">
                            <div class="bg-green-100 p-3 rounded-full mr-4">
                                <i class="fas fa-file-alt text-green-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold">Informe Detallado</h3>
                                <p class="text-sm text-gray-600">Análisis completo</p>
                            </div>
                        </div>
                        <p class="text-gray-700 text-sm">Reporte exhaustivo con detalles de cada proyecto, avances,
                            presupuestos, plazos y responsables asignados.</p>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-xs text-gray-500">Última generación: 1 semana atrás</span>
                            <button class="text-green-600 hover:text-green-800">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <div class="report-card bg-white rounded-lg shadow p-6 cursor-pointer"
                        onclick="selectReportType('financial')">
                        <div class="flex items-center mb-4">
                            <div class="bg-yellow-100 p-3 rounded-full mr-4">
                                <i class="fas fa-coins text-yellow-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold">Informe Financiero</h3>
                                <p class="text-sm text-gray-600">Estado presupuestario</p>
                            </div>
                        </div>
                        <p class="text-gray-700 text-sm">Análisis financiero detallado con ejecución presupuestaria,
                            flujo de caja, costos proyectados y desviaciones.</p>
                        <div class="mt-4 flex justify-between items-center">
                            <span class="text-xs text-gray-500">Última generación: 3 días atrás</span>
                            <button class="text-yellow-600 hover:text-yellow-800">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Evolución de Proyectos</h3>
                        <div class="chart-container">
                            <canvas id="projectEvolutionChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4">Distribución Presupuestaria</h3>
                        <div class="chart-container">
                            <canvas id="budgetDistributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Reports -->
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Informes Recientes</h3>
                        <button onclick="viewAllReports()" class="text-blue-600 hover:text-blue-800 text-sm">
                            Ver todos <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div
                            class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-file-pdf text-red-500 text-xl"></i>
                                <div>
                                    <p class="font-medium">Informe Ejecutivo - Septiembre 2025</p>
                                    <p class="text-sm text-gray-600">Generado por: Admin | 2 días atrás</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="downloadReport('executive_sept_2025')"
                                    class="text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button onclick="viewReport('executive_sept_2025')"
                                    class="text-green-600 hover:text-green-800">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="shareReport('executive_sept_2025')"
                                    class="text-gray-600 hover:text-gray-800">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div
                            class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-file-excel text-green-500 text-xl"></i>
                                <div>
                                    <p class="font-medium">Reporte Financiero Q3-2025</p>
                                    <p class="text-sm text-gray-600">Generado por: Finanzas | 1 semana atrás</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="downloadReport('financial_q3_2025')"
                                    class="text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button onclick="viewReport('financial_q3_2025')"
                                    class="text-green-600 hover:text-green-800">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="shareReport('financial_q3_2025')"
                                    class="text-gray-600 hover:text-gray-800">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div
                            class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-file-excel text-green-500 text-xl"></i>
                                <div>
                                    <p class="font-medium">Reporte de Avance de Proyectos</p>
                                    <p class="text-sm text-gray-600">Generado por: SECPLAC | 2 semanas atrás</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="downloadReport('progress_sept_2025')"
                                    class="text-blue-600 hover:text-blue-800">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button onclick="viewReport('progress_sept_2025')"
                                    class="text-green-600 hover:text-green-800">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="shareReport('progress_sept_2025')"
                                    class="text-gray-600 hover:text-gray-800">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../../../script/layout.js"></script>
    <script>
        // Verificar si el usuario está logueado al cargar la página
        document.addEventListener('DOMContentLoaded', function () {
            checkLoginStatus();
            initializeCharts();
        });

        // Inicializar gráficos
        function initializeCharts() {
            // Gráfico de evolución de proyectos
            const evolutionCtx = document.getElementById('projectEvolutionChart');
            if (evolutionCtx) {
                new Chart(evolutionCtx, {
                    type: 'line',
                    data: {
                        labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep'],
                        datasets: [{
                            label: 'Proyectos Iniciados',
                            data: [5, 8, 12, 15, 18, 22, 25, 28, 32],
                            borderColor: '#3B82F6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'Proyectos Completados',
                            data: [2, 3, 5, 7, 9, 12, 14, 16, 18],
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Gráfico de distribución presupuestaria
            const budgetCtx = document.getElementById('budgetDistributionChart');
            if (budgetCtx) {
                new Chart(budgetCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Vialidad', 'Espacios Públicos', 'Saneamiento', 'Educación', 'Salud'],
                        datasets: [{
                            data: [38, 24, 18, 12, 8],
                            backgroundColor: [
                                '#3B82F6',
                                '#10B981',
                                '#06B6D4',
                                '#8B5CF6',
                                '#EF4444'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        // Datos de ejemplo para los informes
        const reportData = {
            executive: {
                title: 'Informe Ejecutivo',
                sections: [
                    { title: 'Resumen Ejecutivo', content: 'Este informe presenta un resumen de los proyectos municipales en curso.' },
                    { title: 'Métricas Clave', content: 'Inversión total: $25.3B, Proyectos activos: 92, Tasa de ejecución: 87%' },
                    { title: 'Recomendaciones', content: 'Se recomienda priorizar los proyectos de saneamiento para el próximo trimestre.' }
                ]
            },
            detailed: {
                title: 'Informe Detallado',
                sections: [
                    { title: 'Introducción', content: 'Análisis detallado del estado actual de todos los proyectos municipales.' },
                    { title: 'Proyectos por Área', content: 'Vialidad: 35 proyectos, Espacios Públicos: 22 proyectos, Saneamiento: 18 proyectos...' },
                    { title: 'Análisis de Riesgos', content: 'Se identificaron 5 proyectos con riesgo de retraso debido a factores climáticos.' }
                ]
            },
            financial: {
                title: 'Informe Financiero',
                sections: [
                    { title: 'Ejecución Presupuestaria', content: 'Presupuesto asignado: $30B, Ejecutado: $26.1B (87%)' },
                    { title: 'Análisis de Costos', content: 'Costos directos: $20B, Costos indirectos: $6.1B' },
                    { title: 'Proyecciones', content: 'Se proyecta una desviación del 3% para el próximo trimestre.' }
                ]
            },
            progress: {
                title: 'Informe de Avance',
                sections: [
                    { title: 'Avance General', content: 'Progreso promedio de todos los proyectos: 68%' },
                    { title: 'Proyectos Destacados', content: 'Mejora de Plaza Central: 95%, Nuevo Acueducto: 78%' },
                    { title: 'Próximos Hitos', content: 'Inauguración Parque Norte: 15 Oct, Inicio Repavimentación Av. Principal: 22 Oct' }
                ]
            }
        };

        // Funciones para informes
        function generateReport() {
            const reportType = document.getElementById('reportType').value;
            const reportPeriod = document.getElementById('reportPeriod').value;
            const reportArea = document.getElementById('reportArea').value;
            const reportFormat = document.getElementById('reportFormat').value;

            // Mostrar spinner en el botón
            const generateBtn = document.getElementById('generateBtn');
            const originalContent = generateBtn.innerHTML;
            generateBtn.innerHTML = '<span class="spinner"></span>Generando...';
            generateBtn.disabled = true;

            // Mostrar mensaje de generación
            showNotification(`Generando informe ${reportType} para período ${reportPeriod}...`, 'info');

            // Simular generación de informe
            setTimeout(() => {
                // Restaurar botón
                generateBtn.innerHTML = originalContent;
                generateBtn.disabled = false;

                // Generar y descargar el informe según el formato
                if (reportFormat === 'pdf') {
                    generatePDFReport(reportType, reportPeriod, reportArea);
                } else if (reportFormat === 'excel') {
                    generateExcelReport(reportType, reportPeriod, reportArea);
                }

                // Añadir a la lista de informes recientes
                addRecentReport(reportType, reportPeriod, reportFormat);

                showNotification(`Informe ${reportType} generado correctamente`, 'success');
            }, 2000);
        }

        function generatePDFReport(reportType, reportPeriod, reportArea) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Obtener datos del informe
            const data = reportData[reportType] || reportData.executive;

            // Configurar fuentes (usar fuentes que soportan caracteres especiales)
            doc.setFont('helvetica');

            // Título
            doc.setFontSize(18);
            doc.text(data.title, 20, 20);

            // Metadatos
            doc.setFontSize(12);
            doc.text(`Tipo: ${reportType}`, 20, 30);
            doc.text(`Período: ${reportPeriod}`, 20, 37);
            doc.text(`Área: ${reportArea}`, 20, 44);
            doc.text(`Fecha: ${new Date().toLocaleDateString('es-ES')}`, 20, 51);

            // Contenido
            let yPosition = 65;
            data.sections.forEach(section => {
                doc.setFontSize(14);
                doc.text(section.title, 20, yPosition);
                yPosition += 10;

                doc.setFontSize(11);
                const lines = doc.splitTextToSize(section.content, 170);
                doc.text(lines, 20, yPosition);
                yPosition += lines.length * 5 + 10;
            });

            // Pie de página
            doc.setFontSize(10);
            doc.text('Geoportal Municipal - Ilustre Municipalidad de Algarrobo', 20, 280);

            // Guardar el PDF
            const fileName = `informe_${reportType}_${reportPeriod}_${Date.now()}.pdf`;
            doc.save(fileName);

            return fileName;
        }

        function generateExcelReport(reportType, reportPeriod, reportArea) {
            // Obtener datos del informe
            const data = reportData[reportType] || reportData.executive;

            // Crear libro de trabajo
            const wb = XLSX.utils.book_new();

            // Crear hoja de cálculo
            const wsData = [
                ['Geoportal Municipal - Ilustre Municipalidad de Algarrobo'],
                [''],
                ['Tipo de Informe:', reportType],
                ['Período:', reportPeriod],
                ['Área:', reportArea],
                ['Fecha de Generación:', new Date().toLocaleDateString('es-ES')],
                [''],
                [data.title],
                ['']
            ];

            // Añadir secciones
            data.sections.forEach(section => {
                wsData.push([section.title]);
                wsData.push([section.content]);
                wsData.push(['']);
            });

            // Añadir métricas adicionales
            wsData.push(['Métricas Clave']);
            wsData.push(['Inversión Total', '$25.3B']);
            wsData.push(['Proyectos Activos', '92']);
            wsData.push(['Tasa de Ejecución', '87%']);
            wsData.push(['Beneficiarios', '15.2K']);

            // Crear hoja de cálculo a partir de los datos
            const ws = XLSX.utils.aoa_to_sheet(wsData);

            // Ajustar anchos de columna
            const colWidths = [
                { wch: 30 }, // Columna A
                { wch: 40 }  // Columna B
            ];
            ws['!cols'] = colWidths;

            // Añadir hoja al libro
            XLSX.utils.book_append_sheet(wb, ws, 'Informe');

            // Generar y descargar el archivo Excel
            const fileName = `informe_${reportType}_${reportPeriod}_${Date.now()}.xlsx`;
            XLSX.writeFile(wb, fileName);

            return fileName;
        }

        function scheduleReport() {
            const reportType = document.getElementById('reportType').value;
            const reportPeriod = document.getElementById('reportPeriod').value;

            showToast(`Programando informe ${reportType} para período ${reportPeriod}...`, 'info');

            setTimeout(() => {
                showToast('Informe programado correctamente', 'success');
            }, 1500);
        }

        function saveReportTemplate() {
            showToast('Guardando plantilla de informe...', 'info');

            setTimeout(() => {
                showToast('Plantilla guardada correctamente', 'success');
            }, 1500);
        }

        function selectReportType(type) {
            document.getElementById('reportType').value = type;
            updateReportPreview();
            document.querySelector('.report-filters').scrollIntoView({ behavior: 'smooth' });
        }

        function updateReportPreview() {
            const reportType = document.getElementById('reportType').value;
            const reportPeriod = document.getElementById('reportPeriod').value;
            const reportArea = document.getElementById('reportArea').value;
            console.log('Actualizando vista previa:', { reportType, reportPeriod, reportArea });
        }

        function downloadReport(reportId) {
            showToast(`Descargando informe ${reportId}...`, 'info');
            setTimeout(() => {
                showToast('Informe descargado correctamente', 'success');
            }, 1000);
        }

        function viewReport(reportId) {
            showToast(`Abriendo informe ${reportId}...`, 'info');
            setTimeout(() => {
                showToast('Informe abierto correctamente', 'success');
            }, 1000);
        }

        function shareReport(reportId) {
            showToast(`Preparando para compartir informe ${reportId}...`, 'info');
            setTimeout(() => {
                showToast('Enlace de informe copiado al portapapeles', 'success');
            }, 1500);
        }

        function viewAllReports() {
            showToast('Abriendo todos los informes...', 'info');
        }

        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') { /* close modals if any */ }
        });
    </script>
</body>

</html>